<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Survey</title>
<style>
.brand img.logo { height:36px; display:block; filter: invert(1) brightness(2); }
  :root { --accent:#000; --max:980px; --button-width: 520px; }
  body { margin:0; font-family: system-ui,-apple-system,Segoe UI,Arial,sans-serif; background:#fff; color:#333; }
  header, footer { background:var(--accent); color:#fff; }
  header { padding:16px 0; }
  footer { padding:18px 0; margin-top:40px; }
  .brand { max-width:var(--max); margin:0 auto; padding:0 20px; display:flex; align-items:center; justify-content:space-between; }
  .brand h1 { font-size:18px; margin:0; font-weight:600; letter-spacing:.3px; }
  main { max-width:var(--max); margin:24px auto; padding:0 20px; }
  .stage { display:flex; flex-direction:column; align-items:center; }
  .progress { height:8px; background:#eee; border-radius:5px; width:100%; overflow:hidden; margin:10px 0 26px; }
  .bar { height:100%; width:0%; background:var(--accent); transition:width .25s; }
  .question { font-size:22px; line-height:1.4; color:#666; text-align:center; margin:22px 0 18px; }
  .btn {
    display:block; width:100%; max-width:var(--button-width);
    background:var(--accent); color:#fff; text-align:center;
    border-radius:10px; border:0; padding:16px 14px; margin:10px 0;
    font-size:18px; cursor:pointer; transition:opacity .2s;
  }
  .btn:hover { opacity:.88; }
  .content { max-width:780px; margin:0 auto; text-align:center; }
  .content img { max-width:560px; width:100%; height:auto; border-radius:10px; margin:12px auto 6px; display:block; }
  .notice { text-align:center; color:#777; font-size:14px; margin-top:14px; }
</style>
</head>
<body>
  <header>
  <div class="brand">
    <img src="prizepaths-logo.png" alt="PrizePaths" class="logo">
    <div></div>
  </div>
</header>


  <main>
    <div class="progress"><div id="bar" class="bar"></div></div>
    <section id="screen" class="stage"></section>
    <p class="notice">Affiliate disclosure: some links may be affiliate; we may earn a commission at no extra cost to you.</p>
  </main>

  <footer>
    <div class="brand"><small>Â© Your Brand</small><small></small></div>
  </footer>

<script>
const FORM_ENDPOINT = '';       // add later when wiring Google Sheets
const RESULTS_URL   = 'results.html';

let config=null, step=0, answers={}, locking=false;
const $ = (s, r=document)=>r.querySelector(s);

async function loadConfig(){
  const r = await fetch('survey-config.json', {cache:'no-store'});
  if(!r.ok) throw new Error('fetch failed');
  return r.json();
}
function setChrome(){
  $('#title').textContent = config.title || 'Survey';
  const pct = Math.round(((step+1)/config.screens.length)*100);
  $('#bar').style.width = pct + '%';
}
function render(){
  const s = config.screens[step];
  const host = $('#screen');
  host.innerHTML = '';
  setChrome();

  if (s.html || s.image) {
    const cont = document.createElement('div');
    cont.className = 'content';
    if (s.label && s.kind!=='radio') {
      const h = document.createElement('div');
      h.className='question';
      h.textContent = s.label;
      cont.appendChild(h);
    }
    if (s.html)  cont.insertAdjacentHTML('beforeend', s.html);
    if (s.image) cont.insertAdjacentHTML('beforeend', `<img src="${s.image}" alt="">`);
    host.appendChild(cont);
  }

  if (s.kind === 'radio') {
    const q = document.createElement('div');
    q.className = 'question';
    q.textContent = s.label || '';
    host.appendChild(q);

    (s.options || []).forEach(opt=>{
      const o = typeof opt==='string' ? {label:opt, value:opt} : opt;
      const b = document.createElement('button');
      b.className = 'btn';
      b.textContent = o.label;
      b.onclick = ()=>{
        if (locking) return; locking=true;
        answers[s.id] = o.value || o.label;
        if (o.href) window.open(o.href, '_blank', 'noopener');
        step++;
        if (step < config.screens.length) render(); else finish();
        setTimeout(()=>locking=false, 120);
      };
      host.appendChild(b);
    });
    return; // don't add Next on radio screens
  }

  // content-only screen = Next button
  const next = document.createElement('button');
  next.className = 'btn';
  next.textContent = 'Next';
  next.onclick = ()=>{ step++; (step < config.screens.length) ? render() : finish(); };
  host.appendChild(next);
}
function finish(){ location.href = RESULTS_URL; }

(async function(){
  try {
    config = await loadConfig();
    step = 0;
    render();
  } catch (e) {
    $('#screen').innerHTML = '<p style="color:#c00;text-align:center;margin:24px 0;">Could not load survey-config.json</p>';
    console.error(e);
  }
})();
</script>
</body>
</html>
